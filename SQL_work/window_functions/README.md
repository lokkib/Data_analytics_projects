# Работа с данными по продажам авокадо

## Описание данных

В таблице находятся данные не за каждый день, а за конец каждой недели. Для каждой даты есть несколько наблюдений, отличающихся по типу авокадо и региону продажи. 

**avocado** — содержит данные об установках приложения по дням.

* date — дата
* average_price — средняя цена одного авокадо
* total_volume — количество проданных авокадо
* plu4046 — количество проданных авокадо PLU* 4046
* plu4225 — количество проданных авокадо PLU 4225
* plu4770 — количество проданных авокадо PLU 4770
* total_bags — всего упаковок
* small_bags — маленькие упаковки
* large_bags — большие
* xlarge_bags — очень большие
* type — обычный или органический
* year — год
* region — город или регион (TotalUS – сразу по США)


## Задачи проекта

1. Узнать, сколько авокадо типа organic было продано в целом к концу каждой недели (накопительная сумма продаж) в двух городах (NewYork, LosAngeles), начиная с начала периода наблюдений (04/01/15). Значения внутри окна отсортировать по дате, а саму таблицу отсортировать по убыванию региона.
2. К предыдущему запросу - добавить разбивку по каждому году.
3. Выяснить, когда объемы продаж обычных  авокадо резко падали по сравнению с предыдущей неделей. Взять данные по США в целом, посчитать разницу между объемом продаж в неделю x и количеством проданных авокадо в течение предыдущей недели.
4. Найти день, когда продажи в Нью-Йорке (NewYork) в 2018 году авокадо типа organic увеличились по сравнению с предыдущей неделей, а conventional – наоборот упали.
5.  Посчитать скользящее среднее цены авокадо  в Нью-Йорке с разбивкой по типу авокадо. В качестве окна использовать текущую неделю и предыдущие две. 


## Стек технологий
* СУБД PostgreSQL
* Redash

