# Работа с данными платформы Airbnb в Берлине

## Описание данных

**listings** —  информация о жилье, включая полные описания, характеристики и средние оценки в отзывах

**calendar_summary** — информация о жилье, включая полные описания, характеристики и средние оценки в отзывах

* listing_id – идентификатор жилья (объявления)
* date – дата
* available – доступность жилья в данный день (t/f)
* price – цена за ночь

**reviews** — отзывы

* listing_id –  идентификатор жилья  
* id – id отзыва
* date – дата отзыва
* reviewer_id – id ревьюера (автора отзыва)
* reviewer_name – имя автора
* comments – сам отзыв


## Задачи проекта

1. Оставить только те объявления, в которых оценка на основе отзывов выше среднего, а число отзывов в месяц составляет строго меньше трёх. Затем отсортировать по убыванию две колонки: сначала по числу отзывов в месяц, потом по оценке.
2. Посчитать среднее расстояние до центра города и вывести идентификаторы объявлений о сдаче отдельных комнат, для которых расстояние оказалось меньше среднего. Результат отсортировать по убыванию.
3. Отобрать объявления из таблицы listings, которые:

	* находятся на расстоянии от центра меньше среднего
	* обойдутся дешевле 100$ в день (price с учетом cleaning_fee, который добавляется к общей сумме за неделю, т.е его нужно делить на кол-во дней)
	* имеют последние отзывы (last_review), начиная с 1 сентября 2018 года
	* имеют WiFi в списке удобств (amenities)

4. Найти в таблице calendar_summary те доступные (available='t') объявления, у которых число отзывов от уникальных пользователей в таблице reviews выше среднего.



## Стек технологий
* СУБД ClickHouse
* Tabix

